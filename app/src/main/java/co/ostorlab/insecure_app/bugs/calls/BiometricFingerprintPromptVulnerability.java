package co.ostorlab.insecure_app.bugs.calls;

import android.content.Context;

import androidx.biometric.BiometricPrompt;
import androidx.fragment.app.FragmentActivity;

import co.ostorlab.insecure_app.BugRule;


public final class BiometricFingerprintPromptVulnerability extends BugRule {
    private final FragmentActivity mActivity;

    public BiometricFingerprintPromptVulnerability(FragmentActivity activity) {
        mActivity = activity;

    }

    @Override
    public void run() throws Exception {
        Context context = getContext();

        BiometricPrompt.AuthenticationCallback authenticationCallback = new BiometricPrompt.AuthenticationCallback() {
        };
        BiometricPrompt.PromptInfo promptInfo = new BiometricPrompt.PromptInfo.Builder()
                .setTitle("Title")
                .setSubtitle("Subtitle")
                .setDescription("Description")
                .build();
        BiometricPrompt biometricPrompt = new BiometricPrompt(this.mActivity, authenticationCallback);
        biometricPrompt.authenticate(promptInfo);
    }

    @Override
    public String getDescription() {
        return "Add rule of using class BiometricPrompt without CryptoObject";
    }

}
