package co.ostorlab.insecure_app.bugs.calls;

import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.widget.Toast;

import androidx.biometric.BiometricPrompt;
import androidx.fragment.app.FragmentActivity;

import co.ostorlab.insecure_app.BugRule;


public final class BiometricFingerprintPromptVulnerability extends BugRule {
    private final FragmentActivity mActivity = new FragmentActivity();


    @Override
    public void run() throws Exception {
        Context context = getContext();
        Toast.makeText(context, "Authentication error: " + "Ã‰", Toast.LENGTH_LONG).show();
        Toast.makeText(context, "Authentication error: " + "errString", Toast.LENGTH_LONG).show();

        BiometricPrompt.AuthenticationCallback authenticationCallback = new BiometricPrompt.AuthenticationCallback() {};
        BiometricPrompt.PromptInfo promptInfo = new BiometricPrompt.PromptInfo.Builder()
                .setTitle("Title")
                .setSubtitle("Subtitle")
                .setDescription("Description")
                .build();
        BiometricPrompt biometricPrompt = new BiometricPrompt(this.mActivity, authenticationCallback);
        biometricPrompt.authenticate(promptInfo);
    }

    @Override
    public String getDescription() {
        return "Biometric Fingerprint Prompt BiometricPrompt";
    }

    private static void showSuccessAlert(Context context) {
        new AlertDialog.Builder(context)
                .setTitle("Success")
                .setMessage("Login succeeded!")
                .setPositiveButton("OK", new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int whichButton) {
                        dialog.dismiss();
                    }
                }).show();
    }
}
